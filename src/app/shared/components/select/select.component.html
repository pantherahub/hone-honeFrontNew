<div class="relative w-full" #dropdownRef>
  <!-- Selector -->
  <button type="button"
    (click)="toggleDropdown()"
    [disabled]="disabled"
    class="w-full border text-sm rounded-lg p-2.5 text-left flex justify-between items-center
      transition focus:outline-none focus:ring-0 bg-white dark:bg-gray-900
      disabled:cursor-not-allowed disabled:border-gray-300
    disabled:bg-gray-100 disabled:text-gray-400
    dark:disabled:bg-gray-800 dark:disabled:text-gray-500 dark:disabled:border-gray-600"
    [ngClass]="{
      'text-gray-500 dark:text-gray-400 border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500 dark:focus:border-blue-500':
        !showError,
      'text-red-600 dark:text-red-500 bg-red-50 border-red-600 dark:border-red-500 focus:border-red-600 dark:focus:border-red-500':
        showError
    }"
  >
    <span>{{ selectedLabel }}</span>
    <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
    </svg>
  </button>

  <!-- Dropdown -->
  @if (isOpen) {
    <div class="absolute mt-1 z-50 w-full bg-white border border-gray-200 rounded-md shadow-lg dark:bg-gray-700 dark:border-gray-600">

      <!-- Searchbox -->
      <div *ngIf="searchable" class="p-2 border-b dark:border-gray-600">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          class="w-full px-2 py-1 text-sm rounded border border-gray-300 focus:outline-none focus:ring focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-500 dark:text-white"
          placeholder="Buscar..." />
      </div>

      <ul class="max-h-60 overflow-y-auto text-sm">
        <li *ngFor="let item of filteredItems"
            (click)="selectItem(item)"
            class="px-4 py-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-white"
            [ngClass]="{
              'bg-blue-100 dark:bg-blue-600 text-blue-800 dark:text-white': item.value === selected,
            }">
          {{ item.label }}
        </li>
        @if (filteredItems.length === 0) {
          <li class="px-4 py-2 text-gray-400 dark:text-gray-500">
            No hay resultados
          </li>
        }
      </ul>
    </div>
  }
</div>
