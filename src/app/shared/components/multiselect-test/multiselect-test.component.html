<div class="relative w-full" (click)="dropdownOpen = !dropdownOpen">
  <!-- Input -->
  <div class="flex flex-wrap gap-1 items-center bg-white border border-gray-300 rounded px-2 py-1 min-h-[40px] cursor-pointer">
    <ng-container *ngIf="multiple; else single">
      <ng-container *ngFor="let item of selected">
        <span class="bg-blue-100 text-blue-700 text-sm px-2 py-1 rounded flex items-center">
          {{ item.label }}
          <button class="ml-1" (click)="toggleOption(item); $event.stopPropagation()">Ã—</button>
        </span>
      </ng-container>
      <input
        *ngIf="searchable"
        [(ngModel)]="searchTerm"
        class="flex-1 text-sm outline-none"
        [placeholder]="selected.length === 0 ? placeholder : ''"
        (click)="$event.stopPropagation()"
      />
    </ng-container>
    <ng-template #single>
      <span class="text-sm text-gray-700">
        {{ selected[0]?.label || placeholder }}
      </span>
    </ng-template>
  </div>

  <!-- Dropdown -->
  <div *ngIf="dropdownOpen" class="absolute z-10 mt-1 bg-white border border-gray-200 w-full rounded shadow-lg max-h-60 overflow-y-auto">
    <div
      *ngFor="let option of filteredOptions()"
      (click)="toggleOption(option)"
      class="px-4 py-2 text-sm hover:bg-gray-100 cursor-pointer"
    >
      {{ option.label }}
    </div>
  </div>
</div>
