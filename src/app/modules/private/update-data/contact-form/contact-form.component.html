<form nz-form nzLayout="vertical" [formGroup]="contactForm" (ngSubmit)="onSubmit()" class="contact-form">

  <div nz-row [nzGutter]="16">
    <nz-col [nzSpan]="24" [nzSm]="12">
      <nz-form-item>
        <nz-form-label [nzRequired]="true" nzFor="occupationId">Cargo</nz-form-label>
        <nz-form-control nzErrorTip="El campo es requerido.">
          <nz-select
            id="occupationId"
            formControlName="occupationId"
            nzShowSearch
            [nzShowArrow]="true"
            nzPlaceHolder="Seleccionar"
            [disabled]="contact !== null"
          >
            <nz-option *ngFor="let occupation of contactOccupations" [nzValue]="occupation.isOccupation" [nzLabel]="occupation.Occupation"></nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </nz-col>

    <nz-col [nzSpan]="24" [nzSm]="12">
      <nz-form-item>
        <nz-form-label [nzRequired]="true" nzFor="officeName">Nombre</nz-form-label>
        <nz-form-control [nzErrorTip]="nameErrorTip">
          <ng-template #nameErrorTip>
            <p *ngIf="contactForm.controls['name'].hasError('required')">El campo es requerido.</p>
          </ng-template>
          <input nz-input id="officeName" formControlName="name" placeholder="Nombre" />
        </nz-form-control>
      </nz-form-item>
    </nz-col>

    <nz-col [nzSpan]="24">
      <nz-form-label [nzRequired]="true">Correo(s)</nz-form-label>
      <div nz-row [nzGutter]="16" formArrayName="emails">
        @for (control of emailsArray.controls; track control; let i = $index) {
          <nz-col [nzSpan]="24" [nzSm]="12">
            <nz-form-item>
              <nz-form-control nzErrorTip="Ingresa un correo válido.">
                <input
                  nz-input
                  type="email"
                  placeholder="Correo"
                  [formControlName]="i"
                />
                <span
                  nz-icon
                  nzType="minus-circle-o"
                  class="dynamic-delete-button"
                  *ngIf="emailsArray.length > 1"
                  (click)="removeEmail(i)"
                ></span>
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        }
        <nz-col [nzSpan]="24" [nzSm]="12">
          <nz-form-item>
            <nz-form-control>
              <button nz-button nzType="dashed" type="button" (click)="addEmail()" [disabled]="emailsArray.length >= 5">
                <span nz-icon nzType="plus"></span> Agregar correo
              </button>
            </nz-form-control>
          </nz-form-item>
        </nz-col>
      </div>
    </nz-col>

    <nz-col [nzSpan]="24" [nzSm]="24">
      <nz-form-label [nzRequired]="true">Teléfonos</nz-form-label>
      <div nz-row [nzGutter]="16" formArrayName="telephones">
        @for (control of telephonesArray.controls; track control; let i = $index) {
          <nz-col [nzSpan]="24" [nzSm]="12">
            <nz-form-item>
              <nz-form-control nzErrorTip="El campo es requerido.">
                <input
                  nz-input
                  type="text"
                  placeholder="Teléfono"
                  [formControlName]="i"
                />
                <span
                  nz-icon
                  nzType="minus-circle-o"
                  class="dynamic-delete-button"
                  *ngIf="telephonesArray.length > 1"
                  (click)="removeTelephone(i)"
                ></span>
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        }
        <nz-col [nzSpan]="24" [nzSm]="12">
          <nz-form-item>
            <nz-form-control>
              <button nz-button nzType="dashed" type="button" (click)="addTelephone()" [disabled]="telephonesArray.length >= 5">
                <span nz-icon nzType="plus"></span> Agregar
              </button>
            </nz-form-control>
          </nz-form-item>
        </nz-col>
      </div>
    </nz-col>
  </div>

  <div class="footer">
    <button nz-button nzType="primary" type="submit">
      {{ contact ? 'Actualizar' : 'Agregar' }}
    </button>
  </div>

</form>
